import requests
import os

class GoogleAIStudioConnector:
    def __init__(self, api_key=None):
        # API key can be provided directly or via the GOOGLE_API_KEY environment variable
        self.api_key = api_key or os.getenv("GOOGLE_API_KEY")
        self.endpoint = "https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent"

    def generate_content(self, prompt: str):
        url = f"{self.endpoint}?key={self.api_key}"
        headers = {"Content-Type": "application/json"}
        payload = {"contents": [{"parts": [{"text": prompt}]}]}
        response = requests.post(url, json=payload, headers=headers)
        if response.status_code == 200:
            return response.json()
        else:
            raise RuntimeError(f"Error: {response.status_code} {response.text}")

# Example usage:
if __name__ == "__main__":
    # You can set your API key directly or via the environment variable
    connector = GoogleAIStudioConnector("AIzaSyDsCwGDf3jRSSLE_dqS8Q8Ki5iUnX7nXfU")
    prompt = "Summarize HorizCoin node activity for compliance review."
    result = connector.generate_content(prompt)
    print(result)
